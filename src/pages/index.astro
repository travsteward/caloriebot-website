---
import Layout from "../layouts/Layout.astro";
import FeatureCard from "../components/FeatureCard.astro";
import { testimonials } from '../data/testimonials';

// Add Discord client ID
const DISCORD_CLIENT_ID = import.meta.env.DISCORD_CLIENT_ID;
---

<Layout title="CalorieBot - The AI-Powered Discord Gym">
  <main>
    <!-- Hero Section -->
    <section class="bg-dark text-white py-20">
      <div class="container mx-auto px-4 max-w-4xl text-center">
        <h1 class="text-5xl font-bold mb-6">
          Monetize Discord with AI Fitness
        </h1>
        <p class="text-xl mb-8">
          Deliver Stunning Transformations, Create Massive Engagement, and Monetize Your Audience.
        </p>
        <p class="text-lg text-discord mb-10 italic font-medium">
          For Admins, Creators, and Coaches Ready to Monetize Passion Without the Grind.
        </p>
        <a
          href={`https://discord.com/api/oauth2/authorize?client_id=${DISCORD_CLIENT_ID}&permissions=395137251392&scope=bot%20applications.commands`}
          class="inline-block bg-orange-600 hover:bg-orange-500 text-white text-lg font-bold py-3 px-8 rounded-full transition-colors"
        >
          Add to Server
        </a>
      </div>
    </section>

    <!-- Rest of the sections remain unchanged -->
    <!-- AI-Powered Nutrition Section -->
    <section class="py-12 bg-secondary">
      <div class="container mx-auto px-4 max-w-6xl">
        <h2 class="text-3xl font-bold text-white text-center mb-12">
          AI-Powered Nutrition Tracking
        </h2>
        <div class="grid md:grid-cols-3 gap-8">
          <FeatureCard
            title="Photo Calorie Counting"
            description="Snap a photo of your meal, and our AI instantly calculates calories and macros. No guesswork, no hassle."
            icon="ðŸ“¸"
          />
          <FeatureCard
            title="Auto-Logging & Tracking"
            description="Every meal is automatically logged and tracked in your personal dashboard, giving you real-time insights into your nutrition."
            icon="ðŸ“Š"
          />
          <FeatureCard
            title="Conversational Input"
            description="Speak to it like a personal assistant. Say, '100g bacon and 2 pieces of toast,' and it'll log your calories instantly."
            icon="ðŸ’¬"
          />
        </div>
      </div>
    </section>

    <!-- Workout Features Section -->
    <section class="py-12 bg-dark">
      <div class="container mx-auto px-4 max-w-6xl">
        <h2 class="text-3xl font-bold text-white text-center mb-12">
          Built-In Workout Functionality
        </h2>
        <div class="grid md:grid-cols-3 gap-8">
          <FeatureCard
            title="Guided Workouts"
            description="Like iOS workout apps, CalorieBot's native Discord feature guides you through workouts with step-by-step instructions."
            icon="ðŸ’ª"
          />
          <FeatureCard
            title="Track & Compare PRs"
            description="Log your personal records (PRs) and compare them with friends to stay motivated and push your limits."
            icon="ðŸ“ˆ"
          />
          <FeatureCard
            title="Share Completed Workouts"
            description="Celebrate your wins by sharing completed workouts with the community, fostering camaraderie and accountability."
            icon="ðŸŽ‰"
          />
        </div>
      </div>
    </section>

    <!-- Challenge Integration Section -->
    <section class="py-12 bg-secondary">
      <div class="container mx-auto px-4 max-w-6xl">
        <h2 class="text-3xl font-bold text-white text-center mb-12">
          Seamless Challenge Integration ðŸ”„
        </h2>
        <div class="grid md:grid-cols-3 gap-8">
          <FeatureCard
            title="Auto-Pull Progress Data"
            description="Since nutrition and workouts are native to the platform, challenges automatically pull in your progress data."
            icon="ðŸ”„"
          />
          <FeatureCard
            title="Hit Daily Targets"
            description="Track the four pillars of progress together: calorie deficit, workouts, steps, and protein. Celebrate wins and support each other daily."
            icon="ðŸŽ¯"
          />
          <FeatureCard
            title="Gamified Accountability"
            description="Weekly challenges keep members accountable through competition and camaraderie. Miss a target? Complete community-approved redemption challenges."
            icon="ðŸŽ®"
          />
        </div>
      </div>
    </section>

    <!-- Social Proof Section -->
    <section class="py-12 bg-dark">
      <div class="container mx-auto px-4 max-w-5xl">
        <h2 class="text-3xl font-bold text-white text-center mb-12">
          What Our Users Are Saying
        </h2>

        <div class="grid grid-cols-1 sm:grid-cols-2 gap-6">
          {testimonials.map(post => (
            <div class="bg-secondary rounded-xl p-6 text-white">
              <div class="flex items-start gap-3">
                <img
                  src={post.avatar}
                  alt={`${post.author}'s avatar`}
                  width="48"
                  height="48"
                  class="w-12 h-12 rounded-full object-cover bg-gray-600"
                />
                <div class="flex-1">
                  <div class="flex items-center gap-2">
                    <span class="font-bold">{post.author}</span>
                    {post.verified && (
                      <svg class="w-5 h-5 text-discord" viewBox="0 0 24 24">
                        <path fill="currentColor" d="M22.5 12.5c0-1.58-.875-2.95-2.148-3.6.154-.435.238-.905.238-1.4 0-2.21-1.71-3.998-3.818-3.998-.47 0-.92.084-1.336.25C14.818 2.415 13.51 1.5 12 1.5s-2.816.917-3.437 2.25c-.415-.165-.866-.25-1.336-.25-2.11 0-3.818 1.79-3.818 4 0 .494.083.964.237 1.4-1.272.65-2.147 2.018-2.147 3.6 0 1.495.782 2.798 1.942 3.486-.02.17-.032.34-.032.514 0 2.21 1.708 4 3.818 4 .47 0 .92-.086 1.335-.25.62 1.334 1.926 2.25 3.437 2.25 1.512 0 2.818-.916 3.437-2.25.415.163.865.248 1.336.248 2.11 0 3.818-1.79 3.818-4 0-.174-.012-.344-.033-.513 1.158-.687 1.943-1.99 1.943-3.484zm-6.616-3.334l-4.334 6.5c-.145.217-.382.334-.625.334-.143 0-.288-.04-.416-.126l-.115-.094-2.415-2.415c-.293-.293-.293-.768 0-1.06s.768-.294 1.06 0l1.77 1.767 3.825-5.74c.23-.345.696-.436 1.04-.207.346.23.44.696.21 1.04z"/>
                      </svg>
                    )}
                    <span class="text-gray-400">{post.handle}</span>
                  </div>
                  <p class="mt-1 text-sm">{post.content}</p>
                </div>
              </div>
            </div>
          ))}
        </div>
      </div>
    </section>

    <!-- Pricing Section -->
    <section id="pricing" class="py-12 bg-dark">
      <div class="container mx-auto px-4 max-w-5xl">
        <h2 class="text-3xl font-bold text-white text-center mb-12">
          Simple, Transparent Pricing
        </h2>

        <!-- Free Trial Box -->
        <div class="bg-secondary rounded-lg p-8 text-center mb-12">
          <h3 class="text-2xl font-bold text-white mb-4">Try CalorieBot Free for 14 Days</h3>
          <p class="text-gray-300 text-lg mb-6">No credit card required. Full access to all features.</p>
          <a
            href={`https://discord.com/api/oauth2/authorize?client_id=${DISCORD_CLIENT_ID}&permissions=395137251392&scope=bot%20applications.commands`}
            class="inline-block bg-orange-600 hover:bg-orange-500 text-white text-lg font-bold py-3 px-8 rounded-full transition-colors"
          >
            Start Free Trial
          </a>
        </div>

        <div class="grid gap-6 mx-auto">
          <!-- Starter -->
          <div class="bg-secondary rounded-lg p-6 flex flex-col md:flex-row items-center justify-between hover:bg-opacity-80 transition-all">
            <div class="md:w-1/4 text-center md:text-left">
              <h3 class="text-2xl font-bold text-white mb-2">Starter</h3>
              <p class="text-3xl font-bold text-discord mb-2">$29<span class="text-sm text-gray-400">/month</span></p>
              <p class="text-gray-400">Up to 5 active members</p>
            </div>
            <div class="md:w-2/4 text-center md:text-left my-4 md:my-0">
              <p class="text-gray-300">Perfect for friends & family</p>
              <ul class="text-gray-300 list-disc list-inside">
                <li>All core features included</li>
                <li>AI photo tracking</li>
                <li>Guided workouts</li>
                <li>Challenge system</li>
              </ul>
            </div>
            <div class="md:w-1/4 text-center">
              <button
                class="checkout-button bg-discord hover:bg-blue-600 text-white font-bold py-2 px-6 rounded-full transition-colors"
                data-price-id="price_1QjsjILK64haKytlUJnHI6bo"
              >
                Get Started
              </button>
            </div>
          </div>

          <!-- Growth -->
          <div class="bg-secondary rounded-lg p-6 flex flex-col md:flex-row items-center justify-between hover:bg-opacity-80 transition-all">
            <div class="md:w-1/4 text-center md:text-left">
              <h3 class="text-2xl font-bold text-white mb-2">Growth</h3>
              <p class="text-3xl font-bold text-discord mb-2">$99<span class="text-sm text-gray-400">/month</span></p>
              <p class="text-gray-400">Up to 12 active members</p>
            </div>
            <div class="md:w-2/4 text-center md:text-left my-4 md:my-0">
              <p class="text-gray-300">For growing communities</p>
              <ul class="text-gray-300 list-disc list-inside">
                <li>Everything in Starter +</li>
                <li>Retention analytics</li>
                <li>Group coaching tools</li>
              </ul>
            </div>
            <div class="md:w-1/4 text-center">
              <button
                class="checkout-button bg-discord hover:bg-blue-600 text-white font-bold py-2 px-6 rounded-full transition-colors"
                data-price-id="price_1QjsjFLK64haKytlEccmqs7i"
              >
                Get Started
              </button>
            </div>
          </div>

          <!-- Plus -->
          <div class="bg-secondary rounded-lg p-6 flex flex-col md:flex-row items-center justify-between hover:bg-opacity-80 transition-all">
            <div class="md:w-1/4 text-center md:text-left">
              <h3 class="text-2xl font-bold text-white mb-2">Plus</h3>
              <p class="text-3xl font-bold text-discord mb-2">$249<span class="text-sm text-gray-400">/month</span></p>
              <p class="text-gray-400">Up to 35 active members</p>
            </div>
            <div class="md:w-2/4 text-center md:text-left my-4 md:my-0">
              <p class="text-gray-300">For established communities</p>
              <ul class="text-gray-300 list-disc list-inside">
                <li>Everything in Growth +</li>
                <li>1-1 Coaching Tools</li>
                <li>Advanced reporting</li>
              </ul>
            </div>
            <div class="md:w-1/4 text-center">
              <button
                class="checkout-button bg-discord hover:bg-blue-600 text-white font-bold py-2 px-6 rounded-full transition-colors"
                data-price-id="price_1QjsjKLK64haKytlh1GJPwQb"
              >
                Get Started
              </button>
            </div>
          </div>

          <!-- Pro -->
          <div class="bg-secondary rounded-lg p-6 flex flex-col md:flex-row items-center justify-between hover:bg-opacity-80 transition-all">
            <div class="md:w-1/4 text-center md:text-left">
              <h3 class="text-2xl font-bold text-white mb-2">Pro</h3>
              <p class="text-3xl font-bold text-discord mb-2">$459<span class="text-sm text-gray-400">/month</span></p>
              <p class="text-gray-400">Up to 75 active members</p>
            </div>
            <div class="md:w-2/4 text-center md:text-left my-4 md:my-0">
              <p class="text-gray-300">For growing large communities</p>
              <ul class="text-gray-300 list-disc list-inside">
                <li>Everything in Plus +</li>
                <li>Priority support</li>
                <li>Custom onboarding</li>
                <li>Advanced analytics</li>
              </ul>
            </div>
            <div class="md:w-1/4 text-center">
              <button
                class="checkout-button bg-discord hover:bg-blue-600 text-white font-bold py-2 px-6 rounded-full transition-colors"
                data-price-id="price_1QkYErLK64haKytlQNHgb9r6"
              >
                Get Started
              </button>
            </div>
          </div>

          <!-- Elite -->
          <div class="bg-secondary rounded-lg p-6 flex flex-col md:flex-row items-center justify-between hover:bg-opacity-80 transition-all">
            <div class="md:w-1/4 text-center md:text-left">
              <h3 class="text-2xl font-bold text-white mb-2">Elite</h3>
              <p class="text-3xl font-bold text-discord mb-2">$999<span class="text-sm text-gray-400">/month</span></p>
              <p class="text-gray-400">Up to 200 active members</p>
            </div>
            <div class="md:w-2/4 text-center md:text-left my-4 md:my-0">
              <p class="text-gray-300">For large communities</p>
              <ul class="text-gray-300 list-disc list-inside">
                <li>Everything in Pro +</li>
                <li>Custom features requests</li>
                <li>Premium support</li>
                <li>Growth mentorship discord</li>
              </ul>
            </div>
            <div class="md:w-1/4 text-center">
              <button
                class="checkout-button bg-discord hover:bg-blue-600 text-white font-bold py-2 px-6 rounded-full transition-colors"
                data-price-id="price_1QjsjBLK64haKytlmgH3MV3i"
              >
                Get Started
              </button>
            </div>
          </div>

          <!-- Partner -->
          <div class="bg-secondary rounded-lg p-6 flex flex-col md:flex-row items-center justify-between hover:bg-opacity-80 transition-all">
            <div class="md:w-1/4 text-center md:text-left">
              <h3 class="text-2xl font-bold text-white mb-2">Partner</h3>
              <p class="text-3xl font-bold text-discord mb-2">Custom<span class="text-sm text-gray-400"> pricing</span></p>
              <p class="text-gray-400">For large fitness coaching communities</p>
            </div>
            <div class="md:w-2/4 text-center md:text-left my-4 md:my-0">
              <ul class="text-gray-300 list-disc list-inside">
                <li>Partnership % pricing model</li>
                <li>Full server design & branding</li>
                <li>1-1 Growth mentorship</li>
                <li>Priority support</li>
              </ul>
            </div>
            <div class="md:w-1/4 text-center">
              <a
                href="mailto:contact@caloriebot.ai"
                class="inline-block bg-discord hover:bg-blue-600 text-white font-bold py-2 px-6 rounded-full transition-colors"
              >
                Contact Us
              </a>
            </div>
          </div>
        </div>
      </div>
    </section>
  </main>
</Layout>

<!-- Add the script section before closing Layout tag -->
<script define:vars={{ DISCORD_CLIENT_ID }}>
  document.addEventListener("DOMContentLoaded", () => {
    document.querySelectorAll("[data-price-id]").forEach((button) => {
      button.addEventListener("click", () => {
        const priceId = button.getAttribute("data-price-id");

        const params = new URLSearchParams({
          client_id: DISCORD_CLIENT_ID,
          response_type: "code",
          scope: "identify email",
          redirect_uri: "https://caloriebot.ai/oauth/discord/callback",
          state: priceId,
          prompt: "consent",
        });

        const discordUrl = `https://discord.com/api/oauth2/authorize?${params}`;
        window.location.href = discordUrl;
      });
    });
  });
</script>
